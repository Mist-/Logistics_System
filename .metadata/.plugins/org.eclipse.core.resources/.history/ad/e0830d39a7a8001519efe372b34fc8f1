package businesslogic.impl.transfer.hall;

import java.rmi.RemoteException;
import java.util.ArrayList;

import businesslogic.impl.order.OrderList;
import businesslogic.impl.user.InstitutionInfo;
import businesslogic.service.Transfer.hall.ReceiveMoneyService;
import businesslogic.service.order.OrderListService;
import utils.Timestamper;
import data.message.LoginMessage;
import data.message.ResultMessage;
import data.po.AccountPO;
import data.po.OrderPO;
import data.po.ReceiptPO;
import data.po.StaffPO;
import data.service.CompanyDataService;
import data.service.FinancialDataService;
import data.vo.ReceiptVO;

/**
 * øÏµ›‘±Ω·À„
 * @author xu
 *
 */
public class ReceiveMoney implements ReceiveMoneyService{

	long hallID;
	Sender sender;
	OrderListService orders;
	String date;
	
	public String[] getSenders(long hall) throws RemoteException{
		return sender.getAvailableSender();
	}
	
	public String[][] getOrderAndFee(String name,String date){
		long senderID = sender.getSenderID(name);
		this.date = date;
		return orders.getOrderAndFee(senderID, date);
	}
	
	public ReceiptVO createReceipt(String[][] orderAndMoney,String institutionName){
		double money = 0;
		for(int i = 0 ; i < orderAndMoney.length;i++){
			money += Double.parseDouble(orderAndMoney[i][1]);
		}
		
		ReceiptVO receipt = new ReceiptVO();
		receipt.setSender(sender.getChosenSenderName());
		receipt.setSenderID(sender.getChosenSenderID());
		receipt.setMoney(money);
		receipt.setAddress("");
		receipt.setDate(Timestamper.getTimeByDate());
		receipt.setInstitution(institutionName);
		receipt.setSender(receipt.getSender());
		receipt.setPeople(receipt.getSender());
		receipt.setCount(false);
		receipt.setHallID(hallID);
		return receipt;

	}
	
	public ResultMessage receiveMoney(){
		return ResultMessage.SUCCESS;
	}
	
	public ReceiveMoney(long hallID){
		this.hallID = hallID;
		orders = new OrderList(new LoginMessage(ResultMessage.SUCCESS));
	}
}
